<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/sample.css">
    <title>GoogleBooksAjaxã‚’å­¦ã¶</title>
    <style>
        td{
            border-bottom: 1px solid #ccc;
            border-left: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>Bookæ¤œç´¢</h1>
    <div>
        <input type="text" id="key" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
        <button id="send">ğŸ”</button>
    </div>
    <div>
        <table id ="list">
            <tr>
                <td style="width:400px">æ›¸ç±å</td>
                <td style="width:150px">è‘—è€…</td>
                <td style="width:200px">å‡ºç‰ˆç¤¾</td>
                <td style="width:400px">ç”»åƒ</td>
            </tr>
        </table>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        // æ¤œç´¢ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰
        $("#send").on("click",function(){
            const url = "https://www.googleapis.com/books/v1/volumes?q="+$("#key").val();
            $.ajax({
                url: url,
                dataType: "json"
                // dataType: "html"
            }).done(function(data) {
                // const j = JSON.parse(data);
                // æ›¸ç±åã€å‡ºç‰ˆç¤¾ã€ã‚µãƒ ãƒã‚¤ãƒ«[ãƒªãƒ³ã‚¯]
                console.log(data); //ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­ã‚’ç¢ºèª
                // console.log(j);
                const len = data.items.length; //ãƒ‡ãƒ¼ã‚¿ã®æ•°ã‚’å–å¾—
                let html;
                for(let i=0; i<len; i++){
                    console.log(typeof data.items[i].volumeInfo.publisher);
                    if(typeof data.items[i].volumeInfo.publisher=="undefined"){
                        data.items[i].volumeInfo.publisher="å‡ºç‰ˆç¤¾ï¼ˆä¸æ˜ï¼‰"
                    }
                    html += `
                        <tr>
                            <td>${data.items[i].volumeInfo.title}</td>
                            <td>${data.items[i].volumeInfo.authors}</td>
                            <td>${data.items[i].volumeInfo.publisher}</td>
                            <td>
                                <a target="_blank" href="${data.items[i].volumeInfo.infoLink}">
                                    <img src="${data.items[i].volumeInfo.imageLinks.thumbnail}">
                                </a>
                            </td>
                        </tr>
                    `;
                }
                //tableè¦ç´ ã®id="list"ã«è¿½åŠ 
                // $("#list").empty();
                $("#list").empty().hide().append(html).fadeIn(1000);
            });
        });





    </script>
</body>
</html> 
